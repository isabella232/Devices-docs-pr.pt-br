---
title: Gerenciar o Surface Dock 2 com WMI
description: Este artigo explica como usar o WMI para monitorar e gerenciar remotamente o firmware, o estado da política e os dados relacionados mais recentes em todos os dispositivos Surface Dock 2.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
appliesto:
- Windows 10
- Windows 11
ms.openlocfilehash: 658632220dfa87aa88fa233a7d55c311042a91cc
ms.sourcegitcommit: beb2f9db90b19b74da6cdee8717cc0888f3b1d70
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/16/2022
ms.locfileid: "12448894"
---
# <a name="manage-surface-dock-2-with-wmi"></a>Gerenciar o Surface Dock 2 com WMI

Windows suporte a Instrumentação de Gerenciamento (WMI) fornece um rico conjunto de informações de diagnóstico que permitem que os administradores de IT monitorem e gerenciem remotamente o firmware, o estado da política e os dados relacionados mais recentes em todos os dispositivos Surface Dock 2. Você pode usar o WMI com Windows PowerShell, System Center Operations Manager e outras ferramentas. Para obter mais informações sobre o WMI, consulte [Working with WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true). 

Para habilitar o suporte ao WMI, vá para [Drivers e Firmware do Surface Dock 2](https://www.microsoft.com/download/details.aspx?id=101317) e baixe o pacote apropriado:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;versão&#62;_x64.msi:**<br>

- Surface Pro (5ª Geração e posterior)
- Surface Book (2nd Gen e posterior)
- Surface Go (todas as gerações)
- Surface Laptop (todas as gerações)
- Surface Laptop Go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;versão&#62;_arm64.msi:** <br>

- Surface Pro X

## <a name="using-wmi-with-surface-dock-2"></a>Usando o WMI com o Surface Dock 2

1. Para enumerar todas as instâncias de componente de encaixe:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Para acessar descrições da Propriedade de Classe WMI, abra um prompt de comando e insira comandos WMI onde **Property** é uma das propriedades listadas na Tabela 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Exemplo:** Para acessar a descrição da propriedade **CIM (Modelo** de Informação Comum da Versão), insira o seguinte:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### <a name="table-1-surface-dock-2-wmi-reference"></a>Tabela 1. Referência WMI do Surface Dock 2

| Propriedade         | Tipo   | Valores esperados                                                                                                                                                                                                            | Descrição                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | String | "Microcontrolador" <br>"USB Hub 1" <br>"USB Hub 2" <br>"Display Port Hub" <br>"Controlador de Entrega de Energia" <br>"Codec de áudio" <br>"Controlador Ethernet"                                                                         | A propriedade a seguir lista o nome específico do componente do dispositivo ao qual os dados da classe CIM (Common Information Model) que acompanham correspondem.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | String | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | A propriedade a seguir contém o nome do dispositivo de encaixe ao que o componente de dispositivo específico pertence.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | String | Um número de série de doze (12) dígitos contendo apenas valores numéricos                                                                                                                                                           | A propriedade a seguir registra o número de série do dispositivo de encaixe anexado. Esse número de série é exatamente o mesmo para cada componente que pertencem ao mesmo dispositivo de encaixe. Para referência, esse número de série pode ser encontrado fisicamente na parte inferior do próprio Surface Dock.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | uint16 | 0, 1, 2, ..., 65535                                                                                                                                                                                                          | A propriedade a seguir é uma ID exclusiva que começa a partir de zero (0) e conta para cima. Essa variável é usada para numerar as instâncias WMI enumeradas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | String | "Sucesso" <br>"PendingDockReattach" <br>"Falha"                                                                                                                                                                             | A propriedade a seguir detalha o status da última tentativa de Atualização de Firmware de Componente (CFU) para o componente do dispositivo em questão. Os valores possíveis são: **Success,** **Pending Dock Reattach** e **Failed.**<br><br><br>- **O** sucesso indica que o novo firmware aplicado anteriormente foi aplicado com êxito<br>- **A Reattach** pendente do Dock indica que há uma nova atualização pendente para o componente do dispositivo e o usuário deve desconectar e reacoplar o conector Surface do Dock para aplicar a nova atualização.<br>- **Falha** indica que ocorreu um possível erro legítimo durante o processo de CFU ou que o periférico não foi inicializado na versão esperada. No caso **Failed** , isso não é uma indicação de que o dispositivo não está funcionando, mas algo errôneo ocorreu ao tentar atualizar o dispositivo. Nesse caso, o firmware anterior continuará a ser executado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | String | "Habilitado" <br>"Desabilitado"                                                                                                                                                                                                     | A propriedade a seguir indica a política atual do Modo de Gerenciamento do Surface Enterprise (SEMM) para o componente do dispositivo. Os valores possíveis são: **Habilitado e** **Desabilitado.**<br><br><br>- **Habilitado indica** que o sistema SEMM permitiu que o dispositivo host acesse e use o componente do dispositivo<br>- **Desabilitado** indica que o sistema SEMM não foi permitido e, assim, impedirá que o computador host acesse e use o componente do dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String[] | Uma lista de cadeias de caracteres de hexaxa, que pode variar de "0x0000" a "0xFFFF"                                                                                                                                                        | A propriedade a seguir classifica a ID do produto (PID) do componente do dispositivo. É possível que haja mais de um PID listado. No caso de um Hub USB, por exemplo, os dispositivos Super Speed (SS) e De Alta Velocidade (HS) são fixos em um "Hub" singular. Portanto, dois (2) PIDs seriam listados nessa matriz.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | boolean | True ou False                                                                                                                                                        | A propriedade a seguir descreve o estado provisionado do Modo de Gerenciamento do Surface Enterprise (SEMM) do dispositivo Surface Dock. O estado provisionado é exatamente o mesmo para cada componente que pertencem ao mesmo dispositivo de encaixe. Os valores possíveis são: True ou False. Um valor true indica que o dispositivo Surface Dock está gerenciado no momento e, com isso, a funcionalidade da porta pode ser restrita. Consulte o campo de propriedade "PolicyState" para obter mais informações. Um valor false indica que o dispositivo Surface Dock no momento não é gerenciado e não tem restrições de recurso impostas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Status           | String | "OK" <br>"Desconectado" <br>"Erro" <br>"Ausente" <br>"DeviceHandleInUse" <br>"Desabilitado" <br>"NotSupportedByWmi"                                                                                                             | A propriedade a seguir descreve o estado da conexão do Dock com o computador host. Os valores possíveis são: **OK,** **Desconectado,** **Erro, Ausente****,** **DeviceHandleInUse,Disabled** **e** **NotSupportedByWmi.**   <br>- **OK** indica que o dispositivo está conectado com êxito à máquina host e não há problemas, o que inibiria sua funcionalidade <br>- **Desconectado indica** que o conector surface, que fornece a conexão para todos os componentes do dispositivo, não está conectado no momento à máquina host. <br>- **O** erro indica um possível problema com a instância do dispositivo e a interface do dispositivo provavelmente foi rotulada com um ponto de exclamação amarelo no Gerenciador de Dispositivos – verifique a propriedade **StatusCode** para obter informações mais detalhadas sobre o tipo de erro que ocorreu. <br>- **Ausente** indica que o dispositivo era esperado para ter enumerado no computador host, mas por algum motivo não. A **propriedade StatusCode** manterá o valor de 24 para indicar essa situação errônea.<br>- **DeviceHandleInUse** indica que outro processo está se comunicando com o dispositivo, o que proíbe esse Provedor de Instâncias de Gerenciamento (WMI) Windows de suas solicitações de comunicação. Tente executar seu comando WMI novamente! <br> - **Desabilitado** indica que a política atual do Modo de Gerenciamento do Surface Enterprise (SEMM) foi desabilitada e, assim, impediu que o computador host acessava e utilizava o componente do dispositivo. Consulte o **campo da propriedade PolicyState** para obter mais informações.<br>- **NotSupportedByWmi** indica que o dock conectado não tem suporte neste Provedor WMI. Esse status aparecerá para o Surface Dock 1, que atualmente não é suportado por este Provedor de Instâncias WMI.|
| StatusCode       | uint32 | [Device Manager Error Code](/windows-hardware/drivers/install/device-manager-error-messages) obtained from the CIM_LogicalDevice WMI Class (within *cimwin32.mof*) | A propriedade a seguir fornece o código de erro do Gerenciador de Dispositivos para o componente de encaixe determinado. Um valor zero (0) indica que o componente de encaixe está funcionando corretamente; um valor maior que zero (0) indica um problema ou um possível erro com o componente de encaixe. Como o componente do dock pode ser enumerado com várias interfaces de dispositivo, é possível que haja códigos de erro adicionais do Gerenciador de Dispositivos. Este campo de propriedade lista apenas um único código de erro, mesmo se vários estão disponíveis. O Gerenciador de Dispositivos rotulará o dispositivo com um ponto de exclamação amarelo somente quando determinados códigos de erro ocorrerem.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorId         | String | Uma cadeia de caracteres hexaxa que pode variar de "0x0000" a "0xFFFF"                                                                                                                                                                        | A propriedade a seguir observa a ID do Fornecedor (VID) específica do componente do dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Versão          | String | Uma cadeia de caracteres de versão, que tem o formulário da seguinte forma: "x.y.z", onde x, y e z são valores numéricos.                                                                                                                            | A propriedade a seguir especifica a versão atual do firmware, que está sendo executado no componente do dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## <a name="learn-more"></a>Saiba mais

- [Portas do Secure Surface Dock 2 com SEMM](secure-surface-dock-ports-semm.md)
- [Novidades no Surface Dock 2](surface-dock-whats-new.md)
- [Códigos de erro do Gerenciador de Dispositivos](/windows-hardware/drivers/install/device-manager-error-messages)
- [Trabalhando com WMI](/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
